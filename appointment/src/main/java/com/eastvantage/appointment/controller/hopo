from app.config import RECOGNITION_FILE_PATH, SCREENING_FILE_PATH
from app.utils.excel_loader import (
    load_excel_to_json_with_pydantic,
    save_json_to_excel,
)
from typing import Dict, List, Any


def get_data(file_type: str) -> Dict[str, List[Any]]:
    if file_type == "recognition":
        return load_excel_to_json_with_pydantic(RECOGNITION_FILE_PATH)
    elif file_type == "screening":
        return load_excel_to_json_with_pydantic(SCREENING_FILE_PATH)
    else:
        raise ValueError("Invalid file type")


def save_data(file_type: str, sheet_name: str, json_data: List[Dict[str, Any]]):
    if file_type == "recognition":
        save_json_to_excel(RECOGNITION_FILE_PATH, sheet_name, json_data)
    elif file_type == "screening":
        save_json_to_excel(SCREENING_FILE_PATH, sheet_name, json_data)
    else:
        raise ValueError("Invalid file type")
