colKeys.forEach((col, idx) => {
  const th = document.createElement('th');
  th.style.position = 'relative';
  th.style.userSelect = 'none';
  th.style.whiteSpace = 'nowrap';
  th.style.paddingRight = '24px'; // â¬…ï¸ reserve space for icon

  const labelSpan = document.createElement('span');
  labelSpan.textContent = col;

  const hideIcon = document.createElement('span');
  hideIcon.innerHTML = '&#x1f441;&#x200d;&#x1f5e8;'; // ðŸ‘ï¸â€ðŸ—¨ï¸
  hideIcon.title = 'Hide Column';
  hideIcon.style.cursor = 'pointer';
  hideIcon.style.position = 'absolute';
  hideIcon.style.top = '50%';
  hideIcon.style.right = '4px';
  hideIcon.style.transform = 'translateY(-50%)';
  hideIcon.style.fontSize = '14px';
  hideIcon.style.opacity = '0.7';
  hideIcon.style.backgroundColor = '#eee'; // optional: matches header bg

  hideIcon.onclick = () => {
    hiddenCols.add(idx);
    document
      .querySelectorAll(`.sheet-table th:nth-child(${idx + 1}), .sheet-table td:nth-child(${idx + 1})`)
      .forEach((el) => (el.style.display = 'none'));
  };

  th.appendChild(labelSpan);
  th.appendChild(hideIcon);
