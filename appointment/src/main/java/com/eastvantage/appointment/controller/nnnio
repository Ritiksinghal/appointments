let excelData = {
  recognition: {},
  screening: {}
};

document.getElementById('toggleSidebar').addEventListener('click', () => {
  const sidebar = document.getElementById('sidebar');
  const toggleBtn = document.getElementById('toggleSidebar');

  if (sidebar.style.display === 'none' || sidebar.style.display === '') {
    sidebar.style.display = 'block';
    toggleBtn.innerHTML = '&#x25C0;'; // left arrow
  } else {
    sidebar.style.display = 'none';
    toggleBtn.innerHTML = '&#x25B6;'; // right arrow
  }
});

function loadExcelFile(type) {
  fetch(`/${type}`)
    .then(res => res.json())
    .then(data => {
      excelData[type] = data;
      const sheetSelect = document.getElementById(`${type}Sheets`);
      sheetSelect.innerHTML = '';

      Object.keys(data).forEach(sheetName => {
        const option = document.createElement('option');
        option.value = sheetName;
        option.textContent = sheetName;
        sheetSelect.appendChild(option);
      });
    })
    .catch(err => {
      alert(`Failed to load ${type} file`);
      console.error(err);
    });
}

function loadSheet(type) {
  const dropdown = document.getElementById(`${type}Sheets`);
  const sheetName = dropdown.value;
  const sheetData = excelData[type][sheetName];

  if (!sheetData || !sheetData.length) return;

  const contentDiv = document.getElementById('content');
  contentDiv.innerHTML = ''; // clear

  const table = document.createElement('table');

  const header = document.createElement('tr');
  Object.keys(sheetData[0]).forEach(col => {
    const th = document.createElement('th');
    th.textContent = col;
    header.appendChild(th);
  });
  table.appendChild(header);

  sheetData.forEach(row => {
    const tr = document.createElement('tr');
    Object.values(row).forEach(cell => {
      const td = document.createElement('td');
      td.textContent = cell;
      tr.appendChild(td);
    });
    table.appendChild(tr);
  });

  contentDiv.appendChild(table);
}
