function showSheets(type) {
  currentType = type;

  const loader = document.getElementById('loader');
  loader.style.display = 'flex';

  fetch(`/${type}`)
    .then(async res => {
      if (!res.ok) {
        throw new Error(`Server error: ${res.status}`);
      }
      const data = await res.json();

      excelData[type] = data;

      // Hide loader after successful fetch
      loader.style.display = 'none';

      document.getElementById('fileOptions').style.display = 'none';
      document.getElementById('sheetList').style.display = 'block';

      const sheetButtonsDiv = document.getElementById('sheetButtons');
      sheetButtonsDiv.innerHTML = '';

      Object.keys(data).forEach(sheetName => {
        const btn = document.createElement('button');
        btn.className = 'btn';
        btn.textContent = sheetName;
        btn.onclick = () => loadSheet(type, sheetName);
        sheetButtonsDiv.appendChild(btn);
      });
    })
    .catch(err => {
      console.error('Fetch error:', err);
      alert(`Failed to load ${type} file`);
    })
    .finally(() => {
      // Hide spinner no matter what
      loader.style.display = 'none';
    });
}
